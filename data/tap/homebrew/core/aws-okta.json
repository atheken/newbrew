{
  "name": "aws-okta",
  "full_name": "aws-okta",
  "tap": "homebrew/core",
  "oldname": null,
  "oldnames": [],
  "aliases": [],
  "versioned_formulae": [],
  "desc": "Authenticate with AWS using your Okta credentials",
  "license": "MIT",
  "homepage": "https://github.com/segmentio/aws-okta",
  "versions": {
    "stable": "1.0.11",
    "head": null,
    "bottle": true
  },
  "urls": {
    "stable": {
      "url": "https://github.com/segmentio/aws-okta/archive/v1.0.11.tar.gz",
      "tag": null,
      "revision": null,
      "checksum": "444a84cd9c81097a7c462f806605193c5676879133255cfa0f610b7d14756b65"
    }
  },
  "revision": 0,
  "version_scheme": 0,
  "bottle": {
    "stable": {
      "rebuild": 0,
      "root_url": "https://ghcr.io/v2/homebrew/core",
      "files": {
        "arm64_monterey": {
          "cellar": ":any_skip_relocation",
          "url": "https://ghcr.io/v2/homebrew/core/aws-okta/blobs/sha256:52451bf142c4c9253a88a93c599e894299d6d2e1c4c0fae07c92cfb16eab1ac7",
          "sha256": "52451bf142c4c9253a88a93c599e894299d6d2e1c4c0fae07c92cfb16eab1ac7"
        },
        "arm64_big_sur": {
          "cellar": ":any_skip_relocation",
          "url": "https://ghcr.io/v2/homebrew/core/aws-okta/blobs/sha256:6de4fd8fa42cddba3a914ed99123469230646bc2ac2598ff40fd0d0c9bf51efe",
          "sha256": "6de4fd8fa42cddba3a914ed99123469230646bc2ac2598ff40fd0d0c9bf51efe"
        },
        "monterey": {
          "cellar": ":any_skip_relocation",
          "url": "https://ghcr.io/v2/homebrew/core/aws-okta/blobs/sha256:af6cea2f20202c5b10749615f86847d0c3c82d812b7559948d0ab6b886a0f2fd",
          "sha256": "af6cea2f20202c5b10749615f86847d0c3c82d812b7559948d0ab6b886a0f2fd"
        },
        "big_sur": {
          "cellar": ":any_skip_relocation",
          "url": "https://ghcr.io/v2/homebrew/core/aws-okta/blobs/sha256:178f359eaabc71c8a677f89e1acb35fe73ae35ba4010a06876bdb630b66878b2",
          "sha256": "178f359eaabc71c8a677f89e1acb35fe73ae35ba4010a06876bdb630b66878b2"
        },
        "catalina": {
          "cellar": ":any_skip_relocation",
          "url": "https://ghcr.io/v2/homebrew/core/aws-okta/blobs/sha256:2edc4ebb817ff4f0a3188a0c0eea6416ce2a83a6d9b5cc5b3969034ee65e27ca",
          "sha256": "2edc4ebb817ff4f0a3188a0c0eea6416ce2a83a6d9b5cc5b3969034ee65e27ca"
        },
        "mojave": {
          "cellar": ":any_skip_relocation",
          "url": "https://ghcr.io/v2/homebrew/core/aws-okta/blobs/sha256:910418c2dd89b78a7d665cdd8082d9941de433c6c8db800ce0515dfb6c1eb25b",
          "sha256": "910418c2dd89b78a7d665cdd8082d9941de433c6c8db800ce0515dfb6c1eb25b"
        },
        "x86_64_linux": {
          "cellar": ":any_skip_relocation",
          "url": "https://ghcr.io/v2/homebrew/core/aws-okta/blobs/sha256:108a796410008799835a58ab990dca87d12e602bff10a47f49b6b126f223b36c",
          "sha256": "108a796410008799835a58ab990dca87d12e602bff10a47f49b6b126f223b36c"
        }
      }
    }
  },
  "keg_only": false,
  "keg_only_reason": null,
  "options": [],
  "build_dependencies": [
    "go",
    "pkg-config"
  ],
  "dependencies": [
    "libusb"
  ],
  "test_dependencies": [],
  "recommended_dependencies": [],
  "optional_dependencies": [],
  "uses_from_macos": [],
  "uses_from_macos_bounds": [],
  "requirements": [],
  "conflicts_with": [],
  "conflicts_with_reasons": [],
  "link_overwrite": [],
  "caveats": null,
  "installed": [],
  "linked_keg": null,
  "pinned": false,
  "outdated": false,
  "deprecated": false,
  "deprecation_date": null,
  "deprecation_reason": null,
  "disabled": true,
  "disable_date": "2022-07-31",
  "disable_reason": "deprecated_upstream",
  "post_install_defined": false,
  "service": null,
  "tap_git_head": "2706c66e8def3eeba4d9bf1adf66221c8ad70701",
  "ruby_source_path": "Formula/aws-okta.rb",
  "ruby_source_checksum": {
    "sha256": "c51dd48de7ae958eba1e0d948878056a808a2f1b234e60fa5383f4985d7afbd7"
  },
  "date_added": "2018-08-19T11:07:52+02:00",
  "readme": "# aws-okta\n\n`aws-okta` allows you to authenticate with AWS using your Okta credentials.\n\n⚠️ As per [#278](https://github.com/segmentio/aws-okta/issues/278), development and maintenance of `aws-okta` is halted. If you're not already using it, now would be a bad time to start. ⚠️\n\n## Installing\n\n[See the wiki for more installation options.](https://github.com/segmentio/aws-okta/wiki/Installation)\n\n### MacOS\n\nYou can install with `brew`:\n\n```bash\n$ brew install aws-okta\n```\n\nShout-out to the fine maintainers of [the core formula](https://github.com/Homebrew/homebrew-core/blob/master/Formula/aws-okta.rb).\n\n### Linux\n\n[Download a binary from our release page](https://github.com/segmentio/aws-okta/releases), or [see the wiki for more installation options like deb/rpm packages](https://github.com/segmentio/aws-okta/wiki/Installation).\n\n### Windows\n\nSee [docs/windows.md](docs/windows.md) for information on getting this working with Windows.\n\n## Usage\n\n### Adding Okta credentials\n\n```bash\n$ aws-okta add\n```\n\nThis will prompt you for your Okta organization, custom domain, region, username, and password. These credentials will then be stored in your keyring for future use.\n\n### Exec\n\n```bash\n$ aws-okta exec <profile> -- <command>\n```\n\nExec will assume the role specified by the given aws config profile and execute a command with the proper environment variables set.  This command is a drop-in replacement for `aws-vault exec` and accepts all of the same command line flags:\n\n```bash\n$ aws-okta help exec\nexec will run the command specified with aws credentials set in the environment\n\nUsage:\n  aws-okta exec <profile> -- <command>\n\nFlags:\n  -a, --assume-role-ttl duration   Expiration time for assumed role (default 1h0m0s)\n  -h, --help                       help for exec\n  -t, --session-ttl duration       Expiration time for okta role session (default 1h0m0s)\n\nGlobal Flags:\n  -b, --backend string   Secret backend to use [kwallet secret-service file] (default \"file\")\n  -d, --debug            Enable debug logging\n```\n\n### Exec for EKS and Kubernetes\n\n`aws-okta` can also be used to authenticate `kubectl` to your AWS EKS cluster. Assuming you have [installed `kubectl`](https://docs.aws.amazon.com/eks/latest/userguide/install-kubectl.html), [setup your kubeconfig](https://docs.aws.amazon.com/eks/latest/userguide/create-kubeconfig.html) and [installed `aws-iam-authenticator`](https://docs.aws.amazon.com/eks/latest/userguide/configure-kubectl.html), you can now access your EKS cluster with `kubectl`. Note that on a new cluster, your Okta CLI user needs to be using the same assumed role as the one who created the cluster. Otherwise, your cluster needs to have been configured to allow your assumed role.\n\n```bash\n$ aws-okta exec <profile> -- kubectl version --short\n```\n\nLikewise, most Kubernetes projects should work, like Helm and Ark.\n\n```bash\n$ aws-okta exec <profile> -- helm version --short\n```\n\n### Configuring your aws config\n\n`aws-okta` assumes that your base role is one that has been configured for Okta's SAML integration by your Okta admin. Okta provides a guide for setting up that integration [here](https://support.okta.com/help/servlet/fileField?retURL=%2Fhelp%2Farticles%2FKnowledge_Article%2FAmazon-Web-Services-and-Okta-Integration-Guide&entityId=ka0F0000000MeyyIAC&field=File_Attachment__Body__s).  During that configuration, your admin should be able to grab the AWS App Embed URL from the General tab of the AWS application in your Okta org.  You will need to set that value in your `~/.aws/config` file, for example:\n\n```ini\n[okta]\naws_saml_url = home/amazon_aws/0ac4qfegf372HSvKF6a3/965\n```\n\nNext, you need to set up your base Okta role.  This will be one your admin created while setting up the integration.  It should be specified like any other aws profile:\n\n```ini\n[profile okta-dev]\nrole_arn = arn:aws:iam::<account-id>:role/<okta-role-name>\nregion = <region>\n```\n\nYour setup may require additional roles to be configured if your admin has set up a more complicated role scheme like cross account roles.  For more details on the authentication process, see the internals section.\n\n#### A more complex example\n\nThe `aws_saml_url` can be set in the \"okta\" ini section, or on a per profile basis. This is useful if, for example, your organization has several Okta Apps (i.e. one for dev/qa and one for prod, or one for internal use and one for integrations with third party providers). For example:\n\n```ini\n[okta]\n# This is the \"default\" Okta App\naws_saml_url = home/amazon_aws/cuZGoka9dAIFcyG0UllG/214\n\n[profile dev]\n# This profile uses the default Okta app\nrole_arn = arn:aws:iam::<account-id>:role/<okta-role-name>\n\n[profile integrations-auth]\n# This is a distinct Okta App\naws_saml_url = home/amazon_aws/woezQTbGWUaLSrYDvINU/214\nrole_arn = arn:aws:iam::<account-id>:role/<okta-role-name>\n\n[profile vendor]\n# This profile uses the \"integrations-auth\" Okta app combined with secondary role assumption\nsource_profile = integrations-auth\nrole_arn = arn:aws:iam::<account-id>:role/<secondary-role-name>\n\n[profile testaccount]\n# This stores the Okta session in a separate item in the Keyring.\n# This is useful if the Okta session is used or modified by other applications\n# and needs to be isolated from other sessions. It is also useful for\n# development versions or multiple versions of aws-okta running.\nokta_session_cookie_key = okta-session-cookie-test\nrole_arn = arn:aws:iam::<account-id>:role/<okta-role-name>\n```\n\nThe configuration above means that you can use multiple Okta Apps at the same time and switch between them easily.\n\n#### Multiple Okta accounts\nsetup accounts:\n```ini\naws-okta add --account=account-a\naws-okta add --account=account-b\n```\n\ndefine keyring key for each profile:\n```ini\n[profile account-a]\n# This is a distinct Okta App\naws_saml_url = home/amazon_aws/woezQTbGWUaLSrYDvINU/214\nrole_arn = arn:aws:iam::<account-id>:role/<okta-role-name>\nokta_account_name = account-a\n\n[profile account-b]\naws_saml_url = home/amazon_aws/woezQTbGaDAA4rYDvINU/123\nrole_arn = arn:aws:iam::<account-id>:role/<okta-role-name>\nokta_account_name = account-b\n```\n\n#### Configuring Okta assume role and AWS assume role TTLs\n\nThe default TTLs for both the initial SAML assumed role and secondary AWS assumed roles are 1 hour.  This means that AWS credentials will expire every hour.\n\n* *session-ttl*: Duration of initial role assumed by Okta\n* *assume-role-ttl*: Duration of second role assumed\n\nIn addition to specifying session and AWS assume role TTLs with command-line flags, they can be set using environment variables.\n\n```bash\nexport AWS_SESSION_TTL=1h\nexport AWS_ASSUME_ROLE_TTL=1h\n```\n\nThe AWS assume role TTL can also be set per-profile in the aws config:\n\n```ini\n# Example with an initial and secondary role that are configured with a max session duration of 12 hours\n[profile ttldemo]\naws_saml_url = home/amazon_aws/cuZGoka9dAIFcyG0UllG/214\nrole_arn = arn:aws:iam::<account-id>:role/<okta-role-name>\nsession_ttl = 12h\n\n[profile ttldemo-role]\nsource_profile = ttldemo\nrole_arn = arn:aws:iam::<account-id>:role/<secondary-role-name>\nassume_role_ttl = 12h\n```\n\n#### Multi-factor Authentication (MFA) configuration\n\nIf you have a single MFA factor configured, that factor will be automatically selected.  By default, if you have multiple available MFA factors, then you will be prompted to select which one to use.  However, if you have multiple factors and want to specify which factor to use, you can do one of the following:\n\n* Specify on the command line with `--mfa-provider` and `--mfa-factor-type`\n* Specify with environment variables `AWS_OKTA_MFA_PROVIDER` and `AWS_OKTA_MFA_FACTOR_TYPE`\n* Specify in your aws config with `mfa_provider` and `mfa_factor_type`\n\n### Shell completion\n\n`aws-okta` provides shell completion support for BASH and ZSH via the `aws-okta completion` command.\n\n## Backends\n\nWe use 99design's keyring package that they use in `aws-vault`.  Because of this, you can choose between different pluggable secret storage backends just like in `aws-vault`.  You can either set your backend from the command line as a flag, or set the `AWS_OKTA_BACKEND` environment variable.\n\nFor Linux / Ubuntu add the following to your bash config / zshrc etc:\n```\nexport AWS_OKTA_BACKEND=secret-service\n```\n\n## --session-cache-single-item aka AWS_OKTA_SESSION_CACHE_SINGLE_ITEM (alpha)\n\nThis flag enables a new secure session cache that stores all sessions in the same keyring item. For macOS users, this means drastically fewer authorization prompts when upgrading or running local builds.\n\nNo provision is made to migrate sessions between session caches.\n\nImplemented in [https://github.com/segmentio/aws-okta/issues/146](#146).\n\n## Local Development\n\nIf you're developing in Linux, you'll need to get `libusb`. For Ubuntu, install the libusb-1.0-0-dev or use the `Dockerfile` provided in the repo.\n\n## Running Tests\n\n`make test`\n\n## Releasing\n\nPushing a new tag will cause Circle to automatically create and push a linux release.  After this is done, you should run (from a mac):\n\n```bash\n$ export CIRCLE_TAG=`git describe --tags`\n$ make release-mac\n```\n\n## Analytics\n\n`aws-okta` includes some usage analytics code which Segment uses internally for tracking usage of internal tools.  This analytics code is turned off by default, and can only be enabled via a linker flag at build time, which we do not set for public github releases.\n\n## Internals\n\n### Authentication process\n\nWe use the following multiple step authentication:\n\n- Step 1 : Basic authentication against Okta\n- Step 2 : MFA challenge if required\n- Step 3 : Get AWS SAML assertion from Okta\n- Step 4 : Assume base okta role from profile with the SAML Assertion\n- Step 5 : Assume the requested AWS Role from the targeted AWS account to generate STS credentials"
}
