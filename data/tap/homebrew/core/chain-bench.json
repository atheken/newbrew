{
  "name": "chain-bench",
  "full_name": "chain-bench",
  "tap": "homebrew/core",
  "oldname": null,
  "oldnames": [],
  "aliases": [],
  "versioned_formulae": [],
  "desc": "Software supply chain auditing tool based on CIS benchmark",
  "license": "Apache-2.0",
  "homepage": "https://github.com/aquasecurity/chain-bench",
  "versions": {
    "stable": "0.1.7",
    "head": "HEAD",
    "bottle": true
  },
  "urls": {
    "stable": {
      "url": "https://github.com/aquasecurity/chain-bench/archive/v0.1.7.tar.gz",
      "tag": null,
      "revision": null,
      "checksum": "bc42551bde3ce61500d0eea3f4443e29bc2c5d86b1f01e87f929c46ce308ca9a"
    },
    "head": {
      "url": "https://github.com/aquasecurity/chain-bench.git",
      "branch": "main"
    }
  },
  "revision": 0,
  "version_scheme": 0,
  "bottle": {
    "stable": {
      "rebuild": 0,
      "root_url": "https://ghcr.io/v2/homebrew/core",
      "files": {
        "arm64_ventura": {
          "cellar": ":any_skip_relocation",
          "url": "https://ghcr.io/v2/homebrew/core/chain-bench/blobs/sha256:c86422a1ddd597f84353351f5c77e3ba2f798552d4b4ae30ab1a2f2de612145d",
          "sha256": "c86422a1ddd597f84353351f5c77e3ba2f798552d4b4ae30ab1a2f2de612145d"
        },
        "arm64_monterey": {
          "cellar": ":any_skip_relocation",
          "url": "https://ghcr.io/v2/homebrew/core/chain-bench/blobs/sha256:35983e5f6f4c054c2d2c517cb6465994097e0353575f0739f44f693729c96b02",
          "sha256": "35983e5f6f4c054c2d2c517cb6465994097e0353575f0739f44f693729c96b02"
        },
        "arm64_big_sur": {
          "cellar": ":any_skip_relocation",
          "url": "https://ghcr.io/v2/homebrew/core/chain-bench/blobs/sha256:c2fdcc6689aad1a4423cb5ef265694759562854410bd41bfcaae5530ed26b0f7",
          "sha256": "c2fdcc6689aad1a4423cb5ef265694759562854410bd41bfcaae5530ed26b0f7"
        },
        "ventura": {
          "cellar": ":any_skip_relocation",
          "url": "https://ghcr.io/v2/homebrew/core/chain-bench/blobs/sha256:a0bf6c469e4c139d58665ad3da59a7fbbdeacc1d8fa14a49dacac4f43b5c7596",
          "sha256": "a0bf6c469e4c139d58665ad3da59a7fbbdeacc1d8fa14a49dacac4f43b5c7596"
        },
        "monterey": {
          "cellar": ":any_skip_relocation",
          "url": "https://ghcr.io/v2/homebrew/core/chain-bench/blobs/sha256:988a2f425eb35a050aca2a354cfd1f2552b31270e295e488866f7534fb4cc470",
          "sha256": "988a2f425eb35a050aca2a354cfd1f2552b31270e295e488866f7534fb4cc470"
        },
        "big_sur": {
          "cellar": ":any_skip_relocation",
          "url": "https://ghcr.io/v2/homebrew/core/chain-bench/blobs/sha256:eaf5fda8e47568cf818eb9f07b586b04b7973c8dac9290fc89a6280d3cdd8909",
          "sha256": "eaf5fda8e47568cf818eb9f07b586b04b7973c8dac9290fc89a6280d3cdd8909"
        },
        "catalina": {
          "cellar": ":any_skip_relocation",
          "url": "https://ghcr.io/v2/homebrew/core/chain-bench/blobs/sha256:3ba54ed8c1422ae0f3c9067f3ad898af922b94caa6a0a8ddb60e2a8ba829d746",
          "sha256": "3ba54ed8c1422ae0f3c9067f3ad898af922b94caa6a0a8ddb60e2a8ba829d746"
        },
        "x86_64_linux": {
          "cellar": ":any_skip_relocation",
          "url": "https://ghcr.io/v2/homebrew/core/chain-bench/blobs/sha256:39585a1d4be722d0b0588e7403f1491c919fb06b95f55a82b4246a1879b2c24b",
          "sha256": "39585a1d4be722d0b0588e7403f1491c919fb06b95f55a82b4246a1879b2c24b"
        }
      }
    }
  },
  "keg_only": false,
  "keg_only_reason": null,
  "options": [],
  "build_dependencies": [
    "go"
  ],
  "dependencies": [],
  "test_dependencies": [],
  "recommended_dependencies": [],
  "optional_dependencies": [],
  "uses_from_macos": [],
  "uses_from_macos_bounds": [],
  "requirements": [],
  "conflicts_with": [],
  "conflicts_with_reasons": [],
  "link_overwrite": [],
  "caveats": null,
  "installed": [],
  "linked_keg": null,
  "pinned": false,
  "outdated": false,
  "deprecated": false,
  "deprecation_date": null,
  "deprecation_reason": null,
  "disabled": false,
  "disable_date": null,
  "disable_reason": null,
  "post_install_defined": false,
  "service": null,
  "tap_git_head": "4eeae4ea50839e967536ba646d5e0ed6fbcbad7f",
  "ruby_source_path": "Formula/chain-bench.rb",
  "ruby_source_checksum": {
    "sha256": "92f61f6f157cabc3e6a7c7d2bff53cb4c789265e70f82a4269eac9991f12a048"
  },
  "date_added": "2022-07-26T17:07:22+00:00",
  "readme": "<p align=\"center\">\n<picture>\n  <source media=\"(prefers-color-scheme: dark)\" srcset=\"docs/imgs/banner_dm.png\">\n  <source media=\"(prefers-color-scheme: light)\" srcset=\"docs/imgs/banner_lm.png\">\n  <img alt=\"chain-bench logo\" src=\"docs/imgs/banner_lm.png\">\n</picture>\n\n</p>\n\n<p align=\"center\">\n\n[üìñ Documentation][docs]\n\nChain-bench is an open-source tool for auditing your software supply chain stack for security compliance based on a new \n  <a href=\"docs/CIS-Software-Supply-Chain-Security-Guide-v1.0.pdf\">CIS Software Supply Chain benchmark</a>.\nThe auditing focuses on the entire SDLC process, where it can reveal risks from code time into deploy time. To win the race against hackers and protect your sensitive data and customer trust, you need to ensure your code is compliant with your organization‚Äôs policies.\n\nRead more in the [Chain-bench Documentation][docs]\n</p>\n\n[![Go Reference](https://pkg.go.dev/badge/github.com/aquasecurity/chain-bench.svg?style=flat-square)](https://pkg.go.dev/github.com/aquasecurity/chain-bench)\n[![GitHub Release][release-img]][release]\n[![Downloads][download]][release]\n[![DockerHub Pulls][docker-pull-img]][docker-pull]\n[![Build Status](https://github.com/aquasecurity/chain-bench/workflows/Build/badge.svg?branch=main&style=flat-square)](https://github.com/aquasecurity/chain-bench/actions)\n[![License](https://img.shields.io/badge/License-Apache%202.0-blue.svg?style=flat-square)](https://github.com/aquasecurity/chain-bench/blob/main/LICENSE)\n[![go-report-card][go-report-card]](https://goreportcard.com/report/github.com/aquasecurity/chain-bench)\n\n<!-- ![coverage report](https://img.shields.io/codecov/c/github/aquasecurity/chain-bench?style=flat-square) -->\n\n[download]: https://img.shields.io/github/downloads/aquasecurity/chain-bench/total?logo=github&style=flat-square\n[release-img]: https://img.shields.io/github/release/aquasecurity/chain-bench.svg?logo=github&style=flat-square\n[release]: https://github.com/aquasecurity/chain-bench/releases\n[docker-pull]: https://cloud.docker.com/repository/docker/aquasec/chain-bench\n[docker-pull-img]: https://img.shields.io/docker/pulls/aquasec/chain-bench.svg\n[go-report-card]: https://goreportcard.com/badge/github.com/aquasecurity/chain-bench?style=flat-square\n\n<figure style=\"text-align: center\">\n  <img src=\"docs/imgs/demo.gif\" alt=\"demo\">\n</figure>\n\n# Contents\n\n- [Contents](#contents)\n- [Introduction](#introduction)\n- [Quick start](#quick-start)\n  - [Installation](#installation)\n  - [Usage](#usage)\n    - [Using docker](#using-docker)\n    - [Using GitHub Actions](#using-github-actions)\n    - [Using Gitlab CI (beta)](#using-gitlab-ci-beta)\n- [Requirements](#requirements)\n- [Supported Providers](#supported-providers)\n- [Please Note](#please-note)\n- [Contributing](#contributing)\n- [Roadmap](#roadmap)\n\n# Introduction\n\nChain-bench is an open-source tool for auditing your software supply chain stack for security compliance based on a new [CIS Software Supply Chain benchmark](/docs/CIS-Software-Supply-Chain-Security-Guide-v1.0.pdf).\nThe auditing focuses on the entire SDLC process, where it can reveal risks from code time into deploy time.\n\n# Quick start\n\nThe primary way to run chain-bench is as a standalone cli. It requires an access token for your account and the repository url in order to access your SCM.\n\n## Installation\n\nGet Chain-bench via your favorite installation method. See [installation] section in the documentation for details. For example:\n\n- `brew install chain-bench`\n- `nix-env --install -A nixpkgs.chain-bench`\n- `docker run aquasec/chain-bench`\n- Download binary from https://github.com/aquasecurity/chain-bench/releases/latest/\n\n## Usage\n\n```bash\nchain-bench scan --repository-url <REPOSITORY_URL> --access-token <TOKEN> -o <OUTPUT_PATH>\n```\n\n### Using Self-hosted or Dedicated SCM Platforms (with custom domains)\n\n```bash\nchain-bench scan --repository-url <REPOSITORY_URL> --scm-platform <SCM_PLATFORM> --access-token <TOKEN> -o <OUTPUT_PATH>\n```\n\nSupported options for `scm-platform` are `\"github\"` and `\"gitlab\"` (beta)\n\n### Using docker\n\n```bash\ndocker run aquasec/chain-bench scan --repository-url <REPOSITORY_URL> --access-token <TOKEN>\n```\n\n### Using GitHub Actions\n\nSee the repository at https://github.com/aquasecurity/chain-bench-action\n\n<details>\n<summary>Example output</summary>\n\n```\n2022-06-13 15:22:18 INF üö©\tFetch Starting\n2022-06-13 15:22:19 INF üè¢\tFetching Organization Settings Finished\n2022-06-13 15:22:29 INF üõ¢Ô∏è\tFetching Repository Settings Finished\n2022-06-13 15:22:29 INF üå±\tFetching Branch Protection Settings Finished\n2022-06-13 15:22:29 INF üë´\tFetching Members Finished\n2022-06-13 15:22:31 INF üîß\tFetching Pipelines Finished\n2022-06-13 15:22:31 INF üèÅ\tFetch succeeded\n   ID                                                 Name                                                Result                  Reason\n-------- ----------------------------------------------------------------------------------------------- -------- ---------------------------------------\n 1.1.3    Ensure any change to code receives approval of two strongly authenticated users                 Passed\n 1.1.4    Ensure previous approvals are dismissed when updates are introduced to a code change proposal   Failed\n 1.1.5    Ensure that there are restrictions on who can dismiss code change reviews                       Failed\n 1.1.6    Ensure code owners are set for extra sensitive code or configuration                            Failed\n 1.1.8    Ensure inactive branches are reviewed and removed periodically                                  Failed   20 inactive branches\n 1.1.9    Ensure all checks have passed before the merge of new code                                      Passed\n 1.1.10   Ensure open git branches are up to date before they can be merged into codebase                 Passed\n 1.1.11   Ensure all open comments are resolved before allowing to merge code changes                     Passed\n 1.1.12   Ensure verifying signed commits of new changes before merging                                   Failed\n 1.1.13   Ensure linear history is required                                                               Passed\n 1.1.14   Ensure branch protection rules are enforced on administrators                                   Failed\n 1.1.15   Ensure pushing of new code is restricted to specific individuals or teams                       Passed\n 1.1.16   Ensure force pushes code to branches is denied                                                  Failed\n 1.1.17   Ensure branch deletions are denied                                                              Failed\n 1.2.1    Ensure all public repositories contain a SECURITY.md file                                       Failed\n 1.2.2    Ensure repository creation is limited to specific members                                       Failed\n 1.2.3    Ensure repository deletion is limited to specific members                                       Passed\n 1.2.4    Ensure issue deletion is limited to specific members                                            Passed\n 1.3.1    Ensure inactive users are reviewed and removed periodically                                     Failed   22 inactive users\n 1.3.3    Ensure minimum admins are set for the organization                                              Passed\n 1.3.5    Ensure the organization is requiring members to use MFA                                         Passed\n 1.3.7    Ensure 2 admins are set for each repository                                                     Failed\n 1.3.8    Ensure strict base permissions are set for repositories                                         Passed\n 1.3.9    Ensure an organization's identity is confirmed with a Verified badge                            Failed\n 2.3.1    Ensure all build steps are defined as code                                                      Failed   No build job was found in pipelines\n 2.3.5    Ensure access to the build process's triggering is minimized                                    Passed\n 2.3.7    Ensure pipelines are automatically scanned for vulnerabilities                                  Passed\n 2.3.8    Ensure scanners are in place to identify and prevent sensitive data in pipeline files           Failed   Repository is not scanned for secrets\n 2.4.2    Ensure all external dependencies used in the build process are locked                           Failed   16 task(s) are not pinned\n 2.4.6    Ensure pipeline steps produce an SBOM                                                           Passed\n 3.1.7    Ensure dependencies are pinned to a specific, verified version                                  Failed   16 dependencies are not pinned\n 3.2.2    Ensure packages are automatically scanned for known vulnerabilities                             Passed\n 3.2.3    Ensure packages are automatically scanned for license implications                              Passed\n 4.2.3    Ensure user's access to the package registry utilizes MFA                                       Passed\n 4.2.5    Ensure anonymous access to artifacts is revoked                                                 Passed\n 4.3.4    Ensure webhooks of the package registry are secured                                             Passed\n-------- ----------------------------------------------------------------------------------------------- -------- ---------------------------------------\n Total Passed Rules: 19 out of 36\n2022-06-13 15:22:31 INF Scan completed: 13.108s\n```\n</details>\n\n\n### Using Gitlab CI (beta)\n\nYou can integrated chain-bench results into [Gitlab Vulnrability Report](https://docs.gitlab.com/ee/user/application_security/vulnerability_report/) by adding a new step within your CI defintion:\n```\nchain-bench-scanning:\n  stage: test\n  image:\n    name: docker.io/aquasec/chain-bench\n    entrypoint: [\"\"]\n  script:\n    - chain-bench scan --repository-url $CI_PROJECT_URL --access-token $CHAIN_BENCH_TOKEN --scm-platform gitlab -o results.json --template @/templates/gitlab_security_scanner.tpl\n  artifacts:\n    reports:\n      container_scanning: results.json\n```\n* You have to create new [token](https://docs.gitlab.com/ee/user/project/settings/project_access_tokens.html) with `Maintainer` role that has `read_api` & `read_repository` permission and use it as environment variables (eg.$CHAIN_BENCH_TOKEN)\n\n\n# Requirements\n\nIt is required to provide an access token with permission to these scopes: `repo`(all), `read:repo_hook`, `admin:org_hook`, `read:org`\n\n# Supported Providers\n\nWe currently support Github and Gitlab SCMs, with PAT authentication.\n\n# Please Note\n\nChain-bench implements the CIS Software Supply Chain Benchmark as closely as possible.\nYou can find the current implemented checks under [AVD - Software Supply Chain CIS - 1.0](https://avd.aquasec.com/compliance/softwaresupplychain/cis-1.0/) that update every night based chain-bench metadata.json files\nPlease raise issues here if chain-bench is not correctly implementing the test as described in the Benchmark. To report issues in the Benchmark itself (for example, tests that you believe are inappropriate), please join the CIS community.\n\n# Contributing\n\nKindly read [Contributing](CONTRIBUTING.md) before contributing.\nWe welcome PRs and issue reports.\n\n# Roadmap\n\nGoing forward we plan to release updates to chain-bench to increase the benchmark coverage with more checks and support more platforms.\nchain-bench is an Aqua Security open source project part of Trivy Family.\n\n[docs]: https://github.com/aquasecurity/chain-bench/blob/main/docs/\n[installation]: https://github.com/aquasecurity/chain-bench/blob/main/docs/getting-started/installation.md\n<!-- TODO: swap to GH pages\n[docs]: https://aquasecurity.github.io/chain-bench\n[installation]: https://aquasecurity.github.io/chain-bench/latest/docs/getting-started/installation/\n-->"
}
